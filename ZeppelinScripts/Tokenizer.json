{"paragraphs":[{"title":"Import Libraries","text":"%pyspark\nimport nltk","user":"anonymous","dateUpdated":"2018-09-27T15:05:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1537891164065_651126567","id":"20180925-155924_30377315","dateCreated":"2018-09-25T15:59:24+0000","dateStarted":"2018-09-27T15:05:12+0000","dateFinished":"2018-09-27T15:05:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13380"},{"title":"Import Cleaned JSON","text":"%pyspark\n# You should run JusText Clean on your input JSON before this script\ncleanDF = spark.read.json(\"/share_dir/attack_westminster_small_cleaned.json\")\ncleanDF.show()","user":"anonymous","dateUpdated":"2018-09-27T15:05:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+\n|         originalUrl|                text|               title|\n+--------------------+--------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|\n|https://www.thegu...|The mind goes num...|The numbing after...|\n|http://www.financ...|Five people died ...|London terror att...|\n|https://www.newst...|People in Westmin...|People in Westmin...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|\n|http://terrorism....|Officer who witne...|Officer who witne...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|\n+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=183","http://172.17.0.2:4040/jobs/job?id=184"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537891216109_1327036146","id":"20180925-160016_156807020","dateCreated":"2018-09-25T16:00:16+0000","dateStarted":"2018-09-27T15:05:12+0000","dateFinished":"2018-09-27T15:05:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13381"},{"text":"%pyspark\nimport string\nfrom nltk.corpus import stopwords\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import ArrayType, StringType\n\ncustom_stopwords = [\"``\", \"''\", \"'s\", \"said\", \"could\", \"also\", \"news\", \"--\", \"...\"]\nstop_words = set(stopwords.words('english') + list(string.punctuation) + custom_stopwords)\n\ndef getTokens(text):\n    from nltk.tokenize import word_tokenize\n    word_tokens = word_tokenize(text.lower().encode('ascii','ignore'))\n    filtered_words = [w for w in word_tokens if w not in stop_words]\n    return filtered_words\ngetTokensUDF = udf(getTokens, ArrayType(StringType()))\n\ntokensDF = cleanDF.withColumn('tokens', getTokensUDF(cleanDF.text))\ntokensDF.show()\n\n    ","user":"anonymous","dateUpdated":"2018-09-27T15:05:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|         originalUrl|                text|               title|              tokens|\n+--------------------+--------------------+--------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[london, attack, ...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[london, hospital...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[mind, goes, numb...|\n|http://www.financ...|Five people died ...|London terror att...|[five, people, di...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[people, westmins...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[metropolitan, po...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[media, captionfo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[popular, videos,...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[found, somewhat,...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[ellwood, mp, bou...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpbb, debug, ph...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[phillip, schofie...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[pm, visits, inju...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[express.co.uk, r...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[watford, muslims...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[subscribe, ft, r...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[postcode, ithere...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[officer, witness...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[video, shows, in...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[police, officers...|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=185"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537891326937_783291465","id":"20180925-160206_875644734","dateCreated":"2018-09-25T16:02:06+0000","dateStarted":"2018-09-27T15:05:13+0000","dateFinished":"2018-09-27T15:05:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13382"},{"text":"%pyspark\ntokensDF.write.json('/share_dir/attack_westminster_small_tokenized.json', \"overwrite\")","user":"anonymous","dateUpdated":"2018-09-27T15:05:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=186"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537891960249_-2001651472","id":"20180925-161240_1632992443","dateCreated":"2018-09-25T16:12:40+0000","dateStarted":"2018-09-27T15:05:14+0000","dateFinished":"2018-09-27T15:05:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13383"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-09-27T15:05:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537982898046_932320568","id":"20180926-172818_1637048507","dateCreated":"2018-09-26T17:28:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13384"}],"name":"Tokenizer","id":"2DT45V6Z6","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}