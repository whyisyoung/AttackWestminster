{"paragraphs":[{"title":"Import Libraries","text":"%pyspark\nimport nltk\nnltk.download('stopwords')","user":"anonymous","dateUpdated":"2018-10-04T19:05:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[nltk_data] Downloading package stopwords to /root/nltk_data...\n[nltk_data]   Package stopwords is already up-to-date!\nTrue\n"}]},"apps":[],"jobName":"paragraph_1537891164065_651126567","id":"20180925-155924_30377315","dateCreated":"2018-09-25T15:59:24+0000","dateStarted":"2018-10-04T19:05:56+0000","dateFinished":"2018-10-04T19:05:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12260"},{"title":"Import Cleaned JSON","text":"%pyspark\n# You should run JusText Clean on your input JSON before this script\ncleanDF = spark.read.json(\"/share_dir/attack_westminster_small_cleaned.json\")\ncleanDF.show()","user":"anonymous","dateUpdated":"2018-10-04T19:05:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+\n|         originalUrl|                text|               title|\n+--------------------+--------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|\n|https://www.thegu...|The mind goes num...|The numbing after...|\n|http://www.financ...|Five people died ...|London terror att...|\n|https://www.newst...|People in Westmin...|People in Westmin...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|\n|http://terrorism....|Officer who witne...|Officer who witne...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|\n+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1537891216109_1327036146","id":"20180925-160016_156807020","dateCreated":"2018-09-25T16:00:16+0000","dateStarted":"2018-10-04T19:05:56+0000","dateFinished":"2018-10-04T19:05:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12261"},{"text":"%pyspark\nimport string\nfrom nltk.corpus import stopwords\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import ArrayType, StringType\n\ncustom_stopwords = [\"``\", \"''\", \"'s\", \"said\", \"could\", \"also\", \"news\", \"--\", \"...\"]\nstop_words = set(stopwords.words('english') + list(string.punctuation) + custom_stopwords)\npunctuation = set([\"``\", \"''\", \"--\", \"...\"] + list(string.punctuation))\n\ndef getTokens(text, stopwords=stop_words):\n    from nltk.tokenize import word_tokenize\n    word_tokens = word_tokenize(text.encode('ascii','ignore'))\n    filtered_words = [w for w in word_tokens if w.lower() not in stopwords]\n    return filtered_words\ngetTokensUDF = udf(getTokens, ArrayType(StringType()))\ngetTokensLowerUDF = udf(lambda tokens: [token.lower() for token in tokens], ArrayType(StringType()))\ngetTokensStopwordsUDF = udf(lambda x: getTokens(x, punctuation), ArrayType(StringType()))\n\n\ntokensDF = cleanDF.withColumn('tokens', getTokensUDF(cleanDF.text))\ntokensDF = tokensDF.withColumn('tokens_lower', getTokensLowerUDF(tokensDF.tokens))\ntokensDF = tokensDF.withColumn('tokens_with_stopwords', getTokensStopwordsUDF(tokensDF.text))\ntokensDF.show()\n\n    ","user":"anonymous","dateUpdated":"2018-10-04T19:05:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+\n|         originalUrl|                text|               title|              tokens|        tokens_lower|tokens_with_stopwords|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[London, attack, ...|[london, attack, ...| [London, attack, ...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[London, hospital...|[london, hospital...| [London, hospital...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[mind, goes, numb...|[mind, goes, numb...| [The, mind, goes,...|\n|http://www.financ...|Five people died ...|London terror att...|[Five, people, di...|[five, people, di...| [Five, people, di...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[People, Westmins...|[people, westmins...| [People, in, West...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[Metropolitan, po...|[metropolitan, po...| [The, Metropolita...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[Media, captionFo...|[media, captionfo...| [Media, captionFo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[Popular, Videos,...|[popular, videos,...| [Popular, Videos,...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[Found, somewhat,...|[found, somewhat,...| [Not, Found, This...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[Ellwood, MP, Bou...|[ellwood, mp, bou...| [Ellwood, who, ha...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpBB, Debug, PH...|[phpbb, debug, ph...| [phpBB, Debug, PH...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[Phillip, Schofie...|[phillip, schofie...| [Phillip, Schofie...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[PM, visits, inju...|[pm, visits, inju...| [PM, visits, inju...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[Express.co.uk, r...|[express.co.uk, r...| [Express.co.uk, r...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[Watford, Muslims...|[watford, muslims...| [Watford, Muslims...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[Subscribe, FT, r...|[subscribe, ft, r...| [Subscribe, to, t...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[Postcode, iThere...|[postcode, ithere...| [Postcode, iThere...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[Officer, witness...|[officer, witness...| [Officer, who, wi...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[Video, shows, in...|[video, shows, in...| [Video, shows, in...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[POLICE, officers...|[police, officers...| [POLICE, officers...|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1537891326937_783291465","id":"20180925-160206_875644734","dateCreated":"2018-09-25T16:02:06+0000","dateStarted":"2018-10-04T19:05:57+0000","dateFinished":"2018-10-04T19:06:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12262"},{"text":"%pyspark\ntokensDF.write.json('/share_dir/attack_westminster_small_tokenized.json', \"overwrite\")","user":"anonymous","dateUpdated":"2018-10-04T19:06:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1537891960249_-2001651472","id":"20180925-161240_1632992443","dateCreated":"2018-09-25T16:12:40+0000","dateStarted":"2018-10-04T19:06:02+0000","dateFinished":"2018-10-04T19:06:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12263"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-10-04T19:06:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537982898046_932320568","id":"20180926-172818_1637048507","dateCreated":"2018-09-26T17:28:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12264"}],"name":"Tokenizer","id":"2DT45V6Z6","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}