{"paragraphs":[{"text":"%pyspark\ntokensDF = spark.read.json(\"/share_dir/attack_westminster_small_tokenized.json\")\ntokensDF.show()","user":"anonymous","dateUpdated":"2018-10-01T01:18:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|         originalUrl|                text|               title|              tokens|\n+--------------------+--------------------+--------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[london, attack, ...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[london, hospital...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[mind, goes, numb...|\n|http://www.financ...|Five people died ...|London terror att...|[five, people, di...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[people, westmins...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[metropolitan, po...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[media, captionfo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[popular, videos,...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[found, somewhat,...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[ellwood, mp, bou...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpbb, debug, ph...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[phillip, schofie...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[pm, visits, inju...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[express.co.uk, r...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[watford, muslims...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[subscribe, ft, r...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[postcode, ithere...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[officer, witness...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[video, shows, in...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[police, officers...|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1537982950500_395309929","id":"20180926-172910_1708768995","dateCreated":"2018-09-26T17:29:10+0000","dateStarted":"2018-10-01T01:18:31+0000","dateFinished":"2018-10-01T01:18:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2365","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0","http://172.17.0.2:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nimport nltk\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import ArrayType, StringType\n\nPOSTagUDF = udf(lambda x: nltk.pos_tag(x), ArrayType(ArrayType(StringType())))\ntaggedDF = tokensDF.withColumn('pos_tags', POSTagUDF(tokensDF.tokens))\ntaggedDF.show()","user":"anonymous","dateUpdated":"2018-10-01T01:18:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+--------------------+\n|         originalUrl|                text|               title|              tokens|            pos_tags|\n+--------------------+--------------------+--------------------+--------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[london, attack, ...|[WrappedArray(lon...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[london, hospital...|[WrappedArray(lon...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[mind, goes, numb...|[WrappedArray(min...|\n|http://www.financ...|Five people died ...|London terror att...|[five, people, di...|[WrappedArray(fiv...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[people, westmins...|[WrappedArray(peo...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[metropolitan, po...|[WrappedArray(met...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[media, captionfo...|[WrappedArray(med...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[popular, videos,...|[WrappedArray(pop...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[found, somewhat,...|[WrappedArray(fou...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[ellwood, mp, bou...|[WrappedArray(ell...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpbb, debug, ph...|[WrappedArray(php...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[phillip, schofie...|[WrappedArray(phi...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[pm, visits, inju...|[WrappedArray(pm,...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[express.co.uk, r...|[WrappedArray(exp...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[watford, muslims...|[WrappedArray(wat...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[subscribe, ft, r...|[WrappedArray(sub...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[postcode, ithere...|[WrappedArray(pos...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[officer, witness...|[WrappedArray(off...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[video, shows, in...|[WrappedArray(vid...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[police, officers...|[WrappedArray(pol...|\n+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1537982981717_-1026615854","id":"20180926-172941_378217771","dateCreated":"2018-09-26T17:29:41+0000","dateStarted":"2018-10-01T01:18:37+0000","dateFinished":"2018-10-01T01:18:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2366","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nfrom collections import Counter\nposRDD = tokensDF.rdd.flatMap(lambda x: nltk.pos_tag(x.tokens))\ncounter = Counter(posRDD.filter(lambda x: x[1][0] == 'N').map(lambda x: x[0]).collect())\ncountDF = spark.createDataFrame(counter.most_common(100), ['noun', 'count'])\ncountDF.show(n=20, truncate=False)","user":"anonymous","dateUpdated":"2018-10-01T01:23:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":536,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----+\n|noun       |count|\n+-----------+-----+\n|police     |1642 |\n|attack     |1317 |\n|people     |1042 |\n|westminster|926  |\n|bridge     |601  |\n|masood     |546  |\n|london     |524  |\n|man        |486  |\n|security   |469  |\n|officer    |465  |\n|attacker   |425  |\n|car        |407  |\n|parliament |381  |\n|officers   |347  |\n|terror     |346  |\n|terrorism  |337  |\n|minister   |311  |\n|palmer     |291  |\n|services   |288  |\n|victims    |276  |\n+-----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1537983055907_-1608567988","id":"20180926-173055_1330165412","dateCreated":"2018-09-26T17:30:55+0000","dateStarted":"2018-10-01T01:23:53+0000","dateFinished":"2018-10-01T01:23:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2367","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=14","http://172.17.0.2:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ncounter = Counter(posRDD.filter(lambda x: x[1][0] == 'V').map(lambda x: x[0]).collect())\ncountDF = spark.createDataFrame(counter.most_common(100), ['verb', 'count'])\ncountDF.show(n=20, truncate=False)","user":"anonymous","dateUpdated":"2018-10-01T01:24:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":444,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----+\n|verb       |count|\n+-----------+-----+\n|told       |344  |\n|killed     |333  |\n|including  |292  |\n|arrested   |205  |\n|armed      |204  |\n|london     |198  |\n|died       |192  |\n|posted     |188  |\n|released   |177  |\n|known      |176  |\n|made       |175  |\n|injured    |174  |\n|following  |161  |\n|know       |160  |\n|westminster|159  |\n|left       |157  |\n|according  |154  |\n|going      |152  |\n|confirmed  |150  |\n|used       |148  |\n+-----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1537997916886_-1796824706","id":"20180926-213836_336265579","dateCreated":"2018-09-26T21:38:36+0000","dateStarted":"2018-10-01T01:24:24+0000","dateFinished":"2018-10-01T01:24:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2368","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=16","http://172.17.0.2:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-09-26T21:40:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537998002507_1714296100","id":"20180926-214002_39688050","dateCreated":"2018-09-26T21:40:02+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2369"}],"name":"POS Tagger","id":"2DSRWYU5C","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}