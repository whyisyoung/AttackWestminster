{"paragraphs":[{"text":"%pyspark\ntokensDF = spark.read.json(\"/share_dir/attack_westminster_small_tokenized.json\")\ntokensDF.show()","user":"anonymous","dateUpdated":"2018-10-02T15:41:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+\n|         originalUrl|                text|               title|              tokens|        tokens_lower|tokens_with_stopwords|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[London, attack, ...|[london, attack, ...| [London, attack, ...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[London, hospital...|[london, hospital...| [London, hospital...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[The, mind, goes,...|[the, mind, goes,...| [The, mind, goes,...|\n|http://www.financ...|Five people died ...|London terror att...|[Five, people, di...|[five, people, di...| [Five, people, di...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[People, Westmins...|[people, westmins...| [People, in, West...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[The, Metropolita...|[the, metropolita...| [The, Metropolita...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[Media, captionFo...|[media, captionfo...| [Media, captionFo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[Popular, Videos,...|[popular, videos,...| [Popular, Videos,...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[Not, Found, This...|[not, found, this...| [Not, Found, This...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[Ellwood, MP, Bou...|[ellwood, mp, bou...| [Ellwood, who, ha...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpBB, Debug, PH...|[phpbb, debug, ph...| [phpBB, Debug, PH...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[Phillip, Schofie...|[phillip, schofie...| [Phillip, Schofie...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[PM, visits, inju...|[pm, visits, inju...| [PM, visits, inju...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[Express.co.uk, r...|[express.co.uk, r...| [Express.co.uk, r...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[Watford, Muslims...|[watford, muslims...| [Watford, Muslims...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[Subscribe, FT, r...|[subscribe, ft, r...| [Subscribe, to, t...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[Postcode, iThere...|[postcode, ithere...| [Postcode, iThere...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[Officer, witness...|[officer, witness...| [Officer, who, wi...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[Video, shows, in...|[video, shows, in...| [Video, shows, in...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[POLICE, officers...|[police, officers...| [POLICE, officers...|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=45","http://172.17.0.2:4040/jobs/job?id=46"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537982950500_395309929","id":"20180926-172910_1708768995","dateCreated":"2018-09-26T17:29:10+0000","dateStarted":"2018-10-02T15:41:52+0000","dateFinished":"2018-10-02T15:41:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5289"},{"text":"%pyspark\nimport nltk\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import ArrayType, StringType\n\nPOSTagUDF = udf(lambda x: nltk.pos_tag(x), ArrayType(ArrayType(StringType())))\ntaggedDF = tokensDF.withColumn('pos_tags', POSTagUDF(tokensDF.tokens_with_stopwords))\ntaggedDF.show()","user":"anonymous","dateUpdated":"2018-10-02T15:41:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+--------------------+\n|         originalUrl|                text|               title|              tokens|        tokens_lower|tokens_with_stopwords|            pos_tags|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[London, attack, ...|[london, attack, ...| [London, attack, ...|[WrappedArray(Lon...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[London, hospital...|[london, hospital...| [London, hospital...|[WrappedArray(Lon...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[The, mind, goes,...|[the, mind, goes,...| [The, mind, goes,...|[WrappedArray(The...|\n|http://www.financ...|Five people died ...|London terror att...|[Five, people, di...|[five, people, di...| [Five, people, di...|[WrappedArray(Fiv...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[People, Westmins...|[people, westmins...| [People, in, West...|[WrappedArray(Peo...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[The, Metropolita...|[the, metropolita...| [The, Metropolita...|[WrappedArray(The...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[Media, captionFo...|[media, captionfo...| [Media, captionFo...|[WrappedArray(Med...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[Popular, Videos,...|[popular, videos,...| [Popular, Videos,...|[WrappedArray(Pop...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[Not, Found, This...|[not, found, this...| [Not, Found, This...|[WrappedArray(Not...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[Ellwood, MP, Bou...|[ellwood, mp, bou...| [Ellwood, who, ha...|[WrappedArray(Ell...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpBB, Debug, PH...|[phpbb, debug, ph...| [phpBB, Debug, PH...|[WrappedArray(php...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[Phillip, Schofie...|[phillip, schofie...| [Phillip, Schofie...|[WrappedArray(Phi...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[PM, visits, inju...|[pm, visits, inju...| [PM, visits, inju...|[WrappedArray(PM,...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[Express.co.uk, r...|[express.co.uk, r...| [Express.co.uk, r...|[WrappedArray(Exp...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[Watford, Muslims...|[watford, muslims...| [Watford, Muslims...|[WrappedArray(Wat...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[Subscribe, FT, r...|[subscribe, ft, r...| [Subscribe, to, t...|[WrappedArray(Sub...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[Postcode, iThere...|[postcode, ithere...| [Postcode, iThere...|[WrappedArray(Pos...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[Officer, witness...|[officer, witness...| [Officer, who, wi...|[WrappedArray(Off...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[Video, shows, in...|[video, shows, in...| [Video, shows, in...|[WrappedArray(Vid...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[POLICE, officers...|[police, officers...| [POLICE, officers...|[WrappedArray(POL...|\n+--------------------+--------------------+--------------------+--------------------+--------------------+---------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=47"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537982981717_-1026615854","id":"20180926-172941_378217771","dateCreated":"2018-09-26T17:29:41+0000","dateStarted":"2018-10-02T15:41:53+0000","dateFinished":"2018-10-02T15:41:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5290"},{"text":"%pyspark\ntaggedDF.write.json('/share_dir/attack_westminster_small_pos_tags.json', \"overwrite\")","user":"anonymous","dateUpdated":"2018-10-02T15:41:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=48"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1538492552550_-479109669","id":"20181002-150232_503551655","dateCreated":"2018-10-02T15:02:32+0000","dateStarted":"2018-10-02T15:41:58+0000","dateFinished":"2018-10-02T15:42:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5291"},{"text":"%pyspark\nfrom collections import Counter\ncustom_stopwords = [\"``\", \"''\", \"'s\", \"said\", \"could\", \"also\", \"news\", \"--\", \"...\"]\nstop_words = set(stopwords.words('english') + list(string.punctuation) + custom_stopwords)\n\nposRDD = taggedDF.rdd.flatMap(lambda x: x.pos_tags).map(lambda x: (x[0].lower(), x[1])).filter(lambda x: x[0] not in stop_words)\ncounter = Counter(posRDD.filter(lambda x: x[1][0] == 'N').map(lambda x: x[0]).collect())\ncountDF = spark.createDataFrame(counter.most_common(100), ['noun', 'count'])\ncountDF.show(n=20, truncate=False)","user":"anonymous","dateUpdated":"2018-10-02T15:42:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":536,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----+\n|noun       |count|\n+-----------+-----+\n|police     |1842 |\n|attack     |1658 |\n|westminster|1325 |\n|london     |1151 |\n|people     |1042 |\n|parliament |780  |\n|masood     |658  |\n|bridge     |646  |\n|man        |486  |\n|security   |469  |\n|officer    |465  |\n|attacker   |455  |\n|car        |407  |\n|incident   |387  |\n|terror     |383  |\n|palmer     |352  |\n|terrorism  |351  |\n|officers   |349  |\n|may        |330  |\n|minister   |311  |\n+-----------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=49","http://172.17.0.2:4040/jobs/job?id=50"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537983055907_-1608567988","id":"20180926-173055_1330165412","dateCreated":"2018-09-26T17:30:55+0000","dateStarted":"2018-10-02T15:42:04+0000","dateFinished":"2018-10-02T15:42:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5292"},{"text":"%pyspark\ncountDF.write.csv(\"/share_dir/attack_westminster_small_freq_nouns.csv\", \"overwrite\")","user":"anonymous","dateUpdated":"2018-10-02T15:42:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=51"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1538494656706_-1350934909","id":"20181002-153736_1155470576","dateCreated":"2018-10-02T15:37:36+0000","dateStarted":"2018-10-02T15:42:09+0000","dateFinished":"2018-10-02T15:42:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5293"},{"text":"%pyspark\ncounter = Counter(posRDD.filter(lambda x: x[1][0] == 'V').map(lambda x: x[0]).collect())\ncountDF = spark.createDataFrame(counter.most_common(100), ['verb', 'count'])\ncountDF.show(n=20, truncate=False)","user":"anonymous","dateUpdated":"2018-10-02T15:42:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":444,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-----+\n|verb     |count|\n+---------+-----+\n|told     |364  |\n|killed   |335  |\n|including|292  |\n|injured  |260  |\n|arrested |225  |\n|shot     |207  |\n|died     |203  |\n|posted   |184  |\n|released |179  |\n|know     |178  |\n|made     |175  |\n|known    |173  |\n|stabbed  |161  |\n|confirmed|160  |\n|saw      |159  |\n|used     |159  |\n|according|154  |\n|going    |152  |\n|added    |146  |\n|left     |145  |\n+---------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=52","http://172.17.0.2:4040/jobs/job?id=53"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537997916886_-1796824706","id":"20180926-213836_336265579","dateCreated":"2018-09-26T21:38:36+0000","dateStarted":"2018-10-02T15:42:10+0000","dateFinished":"2018-10-02T15:42:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5294"},{"text":"%pyspark\ncountDF.write.csv(\"/share_dir/attack_westminster_small_freq_verbs.csv\", \"overwrite\")","user":"anonymous","dateUpdated":"2018-10-02T15:42:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=54"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537998002507_1714296100","id":"20180926-214002_39688050","dateCreated":"2018-09-26T21:40:02+0000","dateStarted":"2018-10-02T15:42:16+0000","dateFinished":"2018-10-02T15:42:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5295"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-10-02T15:42:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538494936494_-1861956228","id":"20181002-154216_1466398177","dateCreated":"2018-10-02T15:42:16+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5296"}],"name":"POS Tagger","id":"2DSRWYU5C","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}