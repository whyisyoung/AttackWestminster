{"paragraphs":[{"text":"%pyspark\nimport nltk\nnltk.download('wordnet')","user":"anonymous","dateUpdated":"2018-10-01T00:23:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538353431833_-366617212","id":"20181001-002351_92081395","dateCreated":"2018-10-01T00:23:51+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4714"},{"text":"%pyspark\ntokensDF = spark.read.json(\"/share_dir/attack_westminster_small_tokenized.json\")\ntokensDF.show()\nfreqTokensDF = spark.read.json('/share_dir/attack_westminster_small_freq_tokens.json')\nfreqTokensDF.show()","user":"anonymous","dateUpdated":"2018-10-01T01:36:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|         originalUrl|                text|               title|              tokens|\n+--------------------+--------------------+--------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[london, attack, ...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[london, hospital...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[mind, goes, numb...|\n|http://www.financ...|Five people died ...|London terror att...|[five, people, di...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[people, westmins...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[metropolitan, po...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[media, captionfo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[popular, videos,...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[found, somewhat,...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[ellwood, mp, bou...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpbb, debug, ph...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[phillip, schofie...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[pm, visits, inju...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[express.co.uk, r...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[watford, muslims...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[subscribe, ft, r...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[postcode, ithere...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[officer, witness...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[video, shows, in...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[police, officers...|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n+-----+-----------+\n|count|       word|\n+-----+-----------+\n| 1981|     police|\n| 1728|     attack|\n| 1326|westminster|\n| 1151|     london|\n| 1042|     people|\n|  806| parliament|\n|  658|     masood|\n|  648|     bridge|\n|  627|        one|\n|  486|        man|\n|  470|        may|\n|  469|   security|\n|  465|    officer|\n|  461|   attacker|\n|  440|  terrorist|\n|  429|         us|\n|  417|        two|\n|  414|   incident|\n|  412|     terror|\n|  407|        car|\n+-----+-----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=20","http://172.17.0.2:4040/jobs/job?id=21","http://172.17.0.2:4040/jobs/job?id=22","http://172.17.0.2:4040/jobs/job?id=23"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1538352461819_-919374162","id":"20181001-000741_1910206221","dateCreated":"2018-10-01T00:07:41+0000","dateStarted":"2018-10-01T01:36:24+0000","dateFinished":"2018-10-01T01:36:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4715"},{"text":"%pyspark\ndef getSynsets(word):\n    from nltk.corpus import wordnet as wn\n    return set(x.name() for x in wn.synsets(word))\nwordnet = set(freqTokensDF.rdd.flatMap(lambda x: getSynsets(x.word)).collect())\ncounter = Counter(tokensDF.rdd.flatMap(lambda x: x.tokens).flatMap(getSynsets).filter(lambda x: x in wordnet).collect())\ncountDF = spark.createDataFrame(counter.most_common(100), ['synset', 'count'])\ncountDF.show(n=20, truncate=False)","user":"anonymous","dateUpdated":"2018-10-01T01:40:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":624,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+-----+\n|synset          |count|\n+----------------+-----+\n|attack.v.02     |2147 |\n|assail.v.01     |2136 |\n|patrol.v.01     |2084 |\n|police.n.01     |2071 |\n|attack.v.05     |2059 |\n|attack.v.01     |2059 |\n|attack.v.03     |2059 |\n|attack.v.06     |2059 |\n|attack.n.05     |2037 |\n|fire.n.09       |2015 |\n|approach.n.01   |2015 |\n|attack.n.01     |1996 |\n|attack.n.09     |1995 |\n|attack.n.08     |1995 |\n|attack.n.07     |1995 |\n|attack.n.06     |1995 |\n|attack.n.02     |1995 |\n|westminster.n.01|1327 |\n|london.n.02     |1171 |\n|london.n.01     |1171 |\n+----------------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=36","http://172.17.0.2:4040/jobs/job?id=37","http://172.17.0.2:4040/jobs/job?id=38"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1538352832478_327965504","id":"20181001-001352_1392683382","dateCreated":"2018-10-01T00:13:52+0000","dateStarted":"2018-10-01T01:39:55+0000","dateFinished":"2018-10-01T01:39:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4717"},{"text":"%pyspark\ndef getLemmas(word):\n    from nltk.corpus import wordnet as wn\n    synsets = wn.synsets(word)\n    lemmas = []\n    for s in synsets:\n        lemmas += s.lemma_names()\n    return set(lemmas)\nwordnet = set(freqTokensDF.rdd.flatMap(lambda x: getLemmas(x.word)).collect())\ncounter = Counter(tokensDF.rdd.flatMap(lambda x: x.tokens).flatMap(getLemmas).filter(lambda x: x in wordnet).collect())\ncountDF = spark.createDataFrame(counter.most_common(100), ['lemma', 'count'])\ncountDF.show(n=20, truncate=False)","user":"anonymous","dateUpdated":"2018-10-01T01:40:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":434,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538353835546_-185871230","id":"20181001-003035_1453901627","dateCreated":"2018-10-01T00:30:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4718","dateFinished":"2018-10-01T01:39:56+0000","dateStarted":"2018-10-01T01:39:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----+\n|lemma   |count|\n+--------+-----+\n|get     |3726 |\n|take    |3676 |\n|go      |2876 |\n|make    |2849 |\n|hold    |2760 |\n|see     |2727 |\n|round   |2442 |\n|blast   |2352 |\n|attempt |2348 |\n|approach|2271 |\n|attack  |2230 |\n|assault |2190 |\n|police  |2173 |\n|fire    |2163 |\n|lash_out|2147 |\n|snipe   |2147 |\n|assail  |2147 |\n|set_on  |2136 |\n|work    |2123 |\n|pass    |2107 |\n+--------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=33","http://172.17.0.2:4040/jobs/job?id=34","http://172.17.0.2:4040/jobs/job?id=35"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-10-01T01:39:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538357973015_-1712479473","id":"20181001-013933_1093735432","dateCreated":"2018-10-01T01:39:33+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5517"}],"name":"Unit 2","id":"2DR7W5RWM","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}