{"paragraphs":[{"text":"%pyspark\ntokensDF = spark.read.json(\"/share_dir/attack_westminster_small_tokenized.json\")\ntokensDF.show()","user":"anonymous","dateUpdated":"2018-09-30T23:52:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|         originalUrl|                text|               title|              tokens|\n+--------------------+--------------------+--------------------+--------------------+\n|https://www.thegu...|London attack: po...|Westminster attac...|[london, attack, ...|\n|http://news.sky.c...|London hospitals ...|Anti-terror barri...|[london, hospital...|\n|https://www.thegu...|The mind goes num...|The numbing after...|[mind, goes, numb...|\n|http://www.financ...|Five people died ...|London terror att...|[five, people, di...|\n|https://www.newst...|People in Westmin...|People in Westmin...|[people, westmins...|\n|https://www.buzzf...|The Metropolitan ...|Here's The Misinf...|[metropolitan, po...|\n|http://news.googl...|Media captionFoot...|London attack: Fo...|[media, captionfo...|\n|https://www.stand...|Popular Videos Kh...|Taliban bomb-make...|[popular, videos,...|\n|http://www.unilad...|Not Found This is...|Page not found - ...|[found, somewhat,...|\n|https://www.rt.co...|Ellwood, who has ...|British politicia...|[ellwood, mp, bou...|\n|http://www.opinie...|[phpBB Debug] PHP...|Muslim leaders ho...|[phpbb, debug, ph...|\n|https://uk.news.y...|Phillip Schofield...|Phillip Schofield...|[phillip, schofie...|\n|https://www.thegu...|PM visits injured...|Westminster attac...|[pm, visits, inju...|\n|https://www.expre...|Express.co.uk rel...|London terror att...|[express.co.uk, r...|\n|http://www.watfor...|Watford Muslims j...|'Love for all, ha...|[watford, muslims...|\n|https://www.ft.co...|Subscribe to the ...|Subscribe to read...|[subscribe, ft, r...|\n|https://stv.tv/ne...|Postcode iThere a...|Police officer st...|[postcode, ithere...|\n|http://terrorism....|Officer who witne...|Officer who witne...|[officer, witness...|\n|http://www.reuter...|Video shows injur...|Video shows injur...|[video, shows, in...|\n|http://www.expres...|POLICE officers a...|Police told NOT t...|[police, officers...|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1537998288212_590216247","id":"20180926-214448_466639711","dateCreated":"2018-09-26T21:44:48+0000","dateStarted":"2018-09-30T23:52:08+0000","dateFinished":"2018-09-30T23:52:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5900"},{"text":"%pyspark\nimport nltk\nfrom collections import Counter\ncounters = tokensDF.rdd.map(lambda x: Counter(x.tokens)).collect()\ncounter = Counter()\nfor c in counters:\n    counter.update(c)\ncountDF = spark.createDataFrame(counter.most_common(100), ['word', 'count'])\ncountDF.show()","user":"anonymous","dateUpdated":"2018-10-01T00:04:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----+\n|       word|count|\n+-----------+-----+\n|     police| 1981|\n|     attack| 1728|\n|westminster| 1326|\n|     london| 1151|\n|     people| 1042|\n| parliament|  806|\n|     masood|  658|\n|     bridge|  648|\n|        one|  627|\n|        man|  486|\n|        may|  470|\n|   security|  469|\n|    officer|  465|\n|   attacker|  461|\n|  terrorist|  440|\n|         us|  429|\n|        two|  417|\n|   incident|  414|\n|     terror|  412|\n|        car|  407|\n+-----------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1537998302195_640026327","id":"20180926-214502_556647031","dateCreated":"2018-09-26T21:45:02+0000","dateStarted":"2018-10-01T00:04:19+0000","dateFinished":"2018-10-01T00:04:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5901"},{"text":"%pyspark\ncountDF.write.json('/share_dir/attack_westminster_small_freq_tokens.json', \"overwrite\")","user":"anonymous","dateUpdated":"2018-10-01T00:05:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1538352277110_1079114063","id":"20181001-000437_423769132","dateCreated":"2018-10-01T00:04:37+0000","dateStarted":"2018-10-01T00:05:03+0000","dateFinished":"2018-10-01T00:05:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5902"},{"text":"%pyspark\ncounters = tokensDF.rdd.map(lambda x: Counter(nltk.bigrams(x.tokens))).collect()\ncounter = Counter()\nfor c in counters:\n    counter.update(c)\ncountDF = spark.createDataFrame(counter.most_common(100), ['bigram', 'count'])\ncountDF.show()","user":"anonymous","dateUpdated":"2018-10-01T00:05:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|              bigram|count|\n+--------------------+-----+\n|[westminster,bridge]|  434|\n|    [police,officer]|  296|\n|     [khalid,masood]|  213|\n|     [terror,attack]|  212|\n|      [keith,palmer]|  207|\n|[metropolitan,pol...|  202|\n|    [prime,minister]|  199|\n| [houses,parliament]|  170|\n|[palace,westminster]|  154|\n|        [posted,mar]|  152|\n|       [theresa,may]|  152|\n|[westminster,attack]|  147|\n|[emergency,services]|  142|\n|[attack,westminster]|  137|\n|      [armed,police]|  132|\n|   [police,officers]|  128|\n|  [terrorist,attack]|  127|\n|          [pc,keith]|  124|\n|     [house,commons]|  120|\n|      [getty,images]|  108|\n+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1537999218476_1375949993","id":"20180926-220018_246642141","dateCreated":"2018-09-26T22:00:18+0000","dateStarted":"2018-10-01T00:05:34+0000","dateFinished":"2018-10-01T00:05:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5903"},{"text":"%pyspark\ncountDF.write.json('/share_dir/attack_westminster_small_freq_bigrams.json', \"overwrite\")","user":"anonymous","dateUpdated":"2018-10-01T00:06:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1538352363428_-1586806602","id":"20181001-000603_1108759079","dateCreated":"2018-10-01T00:06:03+0000","dateStarted":"2018-10-01T00:06:13+0000","dateFinished":"2018-10-01T00:06:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5904"},{"text":"%pyspark\ncounters = tokensDF.rdd.map(lambda x: Counter(nltk.trigrams(x.tokens))).collect()\ncounter = Counter()\nfor c in counters:\n    counter.update(c)\ncountDF = spark.createDataFrame(counter.most_common(100), ['trigram', 'count'])\ncountDF.show(truncate=False)","user":"anonymous","dateUpdated":"2018-10-01T00:06:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------+-----+\n|trigram                          |count|\n+---------------------------------+-----+\n|[pc,keith,palmer]                |121  |\n|[posted,mar,22]                  |72   |\n|[mar,22,2017]                    |72   |\n|[minister,theresa,may]           |68   |\n|[prime,minister,theresa]         |68   |\n|[outside,houses,parliament]      |60   |\n|[westminster,terror,attack]      |48   |\n|[pedestrians,westminster,bridge] |47   |\n|[suspicion,preparation,terrorist]|40   |\n|[preparation,terrorist,acts]     |40   |\n|[adrian,russell,ajao]            |40   |\n|[palace,westminster,london]      |36   |\n|[outside,palace,westminster]     |34   |\n|[incident,westminster,bridge]    |34   |\n|[attacker,khalid,masood]         |34   |\n|[shot,armed,police]              |34   |\n|[officer,keith,palmer]           |33   |\n|[across,westminster,bridge]      |32   |\n|[police,officer,keith]           |31   |\n|[home,secretary,amber]           |31   |\n+---------------------------------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1538351505657_-1220978290","id":"20180930-235145_240397965","dateCreated":"2018-09-30T23:51:45+0000","dateStarted":"2018-10-01T00:06:37+0000","dateFinished":"2018-10-01T00:06:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5905"},{"text":"%pyspark\ncountDF.write.json('/share_dir/attack_westminster_small_freq_trigrams.json', \"overwrite\")","user":"anonymous","dateUpdated":"2018-10-01T00:06:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1538351571384_-341916119","id":"20180930-235251_1460976356","dateCreated":"2018-09-30T23:52:51+0000","dateStarted":"2018-10-01T00:06:58+0000","dateFinished":"2018-10-01T00:06:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5906"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-10-01T00:06:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538352418302_-82730558","id":"20181001-000658_1441142157","dateCreated":"2018-10-01T00:06:58+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5907"}],"name":"Unit 1","id":"2DSKUEWB5","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}